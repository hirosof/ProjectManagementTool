# Phase 5 設計中論点（Claude Code 検出分）

本ファイルは、Phase 5 実装計画の立案中に Claude Code が検出した
**判断が割れそうな論点・設計上の迷い**を記載したものです。

本内容は **Phase 5（Textual版）設計中 論点隔離スレッド【A】** に投げることを想定しています。

---

## 論点1: テンプレート適用時のステータス初期化方針

### 何に迷っているか
フェーズ分解結果では「適用時ステータスはUNSET固定」と記載されているが、
設計整理結果の「Template Apply Wizard」には「ステータス初期化方針選択」という記述がある。

これは矛盾しているのか、それとも将来拡張の余地を残しているのか？

### 現在の案

**案A: UNSET完全固定（選択UI なし）**
- フェーズ分解結果に従い、Phase 5 では UNSET 固定
- UI上での選択肢は提供しない
- シンプル・安全・迷わない

**案B: ステータス初期化方針を選択可能にする**
- UNSET / NOT_STARTED / コピー（元のステータスを維持）から選択
- より柔軟だが、UI分岐が発生
- Phase 5 の「安全に増やすUI」思想と合うか？

### 判断が割れそうな理由
- フェーズ分解結果（P5-4-1）: 「適用時ステータスは UNSET 固定」
- 設計整理結果（P5-6）: 「ステータス初期化方針選択」

この2つの記述が整合していない。

### Phase 5 の思想との関係
「安全に増やすUI」の観点では、案A（UNSET固定）の方が一貫している。
選択肢を増やすことは、UI分岐・迷路化につながる可能性がある。

### 今すぐ決める必要があるか
**ある**
P5-09（テンプレート適用ロジック）、P5-12（Apply Wizard UI）の設計時に必要。

---

## 論点2: テンプレート保存時の include_tasks デフォルト値

### 何に迷っているか
Template Save Wizard で「include_tasks ON/OFF 対応」とあるが、
デフォルト値（初期選択状態）が明記されていない。

ユーザー体験として、どちらをデフォルトにすべきか？

### 現在の案

**案A: ON（Task含む）をデフォルト**
- SubProject配下のTaskまで含めて保存するのが自然
- ユーザーの期待に沿いやすい
- 「構造を再利用する」という目的に合致

**案B: OFF（SubProjectのみ）をデフォルト**
- より安全（Task数が多い場合の誤保存を防ぐ）
- 明示的にONにすることで、意図的な保存を促す
- 慎重な操作を促す

### 判断が割れそうな理由
- 「構造を再利用する」体験 → 案A（ON）が自然
- 「安全に増やすUI」思想 → 案B（OFF）が安全

### Phase 5 の思想との関係
Phase 5 は「安全に増やすUI」を設計思想としているため、
案B（OFF）の方が一貫性がある可能性。

ただし、ユーザー体験として「SubProjectテンプレート」と言いながら
Taskが含まれないのは違和感があるかもしれない。

### 今すぐ決める必要があるか
**ある**
P5-07（テンプレート保存ロジック）、P5-11（Save Wizard UI）の設計時に必要。

---

## 論点3: dry-run 結果の表示粒度

### 何に迷っているか
フェーズ分解結果では「件数サマリ＋簡易ツリー」とあるが、
「簡易」の具体的な粒度が明記されていない。

どこまで詳細を見せるべきか？

### 現在の案

**案A: 件数サマリのみ（最小）**
- 「SubProject: 1件、Task: 5件、SubTask: 12件」といった件数表示のみ
- シンプルだが、構造の把握が難しい

**案B: 件数サマリ + 1階層のみのツリー**
- SubProject名とその直下のTask名のみ表示（SubTaskは件数のみ）
- ある程度の構造把握が可能

**案C: 件数サマリ + 完全なツリー**
- SubProject → Task → SubTask の全階層を表示
- 構造は完全に把握できるが、画面が長くなる可能性

**案D: 件数サマリ + 折りたたみ可能なツリー**
- デフォルトは1階層、展開すれば全階層表示
- 柔軟だが、UI実装が複雑化

### 判断が割れそうな理由
- 「dry-run プレビュー必須」という要件はあるが、粒度の指定がない
- ユーザーが「何が作られるか」を理解できる必要がある
- 一方で、情報過多は迷路化につながる

### Phase 5 の思想との関係
「安全に増やすUI」の観点では、適切な情報量の提示が重要。
情報不足は不安、情報過多は混乱につながる。

案B（1階層のみ）または案C（完全なツリー）が候補だが、
SubProjectテンプレートの規模次第で適切な粒度は変わる可能性がある。

### 今すぐ決める必要があるか
**ある**
P5-09（テンプレート適用ロジック）、P5-12（Apply Wizard UI）の設計時に必要。

ただし、実装後のフィードバックで調整する余地はある。

---

## 論点4: 依存関係の再接続状況の可視化

### 何に迷っているか
テンプレート適用時に「内部依存関係のみ再接続」されるが、
その再接続状況を dry-run 時に見せるべきか？

例: 「Task A → Task B の依存関係が再接続されます」といった情報

### 現在の案

**案A: 見せない（件数サマリ + 簡易ツリーのみ）**
- 依存関係は「内部依存のみ」という前提で自動処理
- ユーザーに追加情報を提示しない
- シンプルだが、不安を感じる可能性

**案B: 見せる（依存関係の再接続リストを表示）**
- 「以下の依存関係が再接続されます:」といったリスト表示
- より安心感があるが、情報量が増える
- 依存関係が多い場合、画面が長くなる

### 判断が割れそうな理由
- 「dry-run プレビュー必須」という要件の解釈
  - 「何が作られるか」だけでよいのか？
  - 「どう再接続されるか」まで見せるべきか？

### Phase 5 の思想との関係
「安全に増やすUI」の観点では、案B（見せる）の方が安心感がある。
ただし、情報過多による混乱を避ける必要もある。

### 今すぐ決める必要があるか
**ない**
論点3（dry-run表示粒度）が確定した後で判断してもよい。
初期実装では案A（見せない）で進め、後で拡張する選択肢もある。

---

## 論点5: テンプレート名の重複チェックタイミング

### 何に迷っているか
テンプレート保存時の名前入力で、既存テンプレート名と重複した場合の挙動。

フェーズ分解結果では「テンプレート名衝突時はエラー」とあるが、
エラーを出すタイミングが明記されていない。

### 現在の案

**案A: 保存実行時にエラー**
- 名前入力 → 確認 → 保存実行 → エラー発生
- 入力画面に戻る
- 確認画面を経由する分、手戻りが大きい

**案B: 確認画面でチェック・警告**
- 名前入力 → 確認（この時点で重複チェック）→ 警告表示
- 保存実行前に気づける
- よりユーザーフレンドリー

**案C: 入力中にリアルタイムチェック**
- 名前入力フィールドで入力中に重複を検出・表示
- 最も早く気づけるが、UI実装が複雑化

### 判断が割れそうな理由
- 「衝突時はエラー」という要件はあるが、タイミングの指定がない
- ユーザー体験として、早く気づける方が良い

### Phase 5 の思想との関係
「安全に増やすUI」の観点では、早期のフィードバックが望ましい。
案B（確認画面でチェック）または案C（リアルタイム）が候補。

### 今すぐ決める必要があるか
**ある**
P5-11（Save Wizard UI）の設計時に必要。

---

## まとめ

上記5つの論点を **Phase 5（Textual版）設計中 論点隔離スレッド【A】** に投げます。

特に以下の3つは実装前に確定が必要：
- **論点1**: ステータス初期化方針（P5-09, P5-12で必要）
- **論点2**: include_tasks デフォルト値（P5-07, P5-11で必要）
- **論点5**: テンプレート名重複チェックタイミング（P5-11で必要）

論点3、論点4は初期実装後に調整する余地があります。
