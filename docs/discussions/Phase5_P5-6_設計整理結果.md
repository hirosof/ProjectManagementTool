# Phase 5（Textual版）設計整理結果（確定事項共有）

本資料は、  
プロジェクト管理ツール **Phase 5（Textual版）** に関する  
UI構成・操作フローの設計整理結果を共有するものです。

本内容は ChatGPT 側での設計整理スレッド【B】にて議論・確定済みであり、  
以降の実装・設計判断は本資料を前提としてください。

---

## Phase 5 の前提

- Phase 5 は **Textual を用いた全画面TUI版**
- Phase 4 までの CLI 版とは **別プログラム／別系統**
- Phase 5 のスコープは確定済み
  - 重心は **SubProjectテンプレート機能**
- Phase 6 以降の機能は扱わない
- Phase 5 は **「安全に増やすUI」** を設計思想とする

---

## 確定事項①：Project直下Taskの扱い

- Phase 5 UI では **Project直下Taskは表示（閲覧）のみ**
- 以下の操作は UI からは提供しない
  - 作成 / 編集 / 削除
  - ステータス変更
  - 依存関係の編集
- 更新が必要な場合は **CLI版の責務**

目的：
- UI分岐・整合性バグの混入を防ぐ
- Phase 5 の重心（テンプレUI）に集中するため

---

## 確定事項②：テンプレ適用先のデフォルト

- テンプレ適用時の展開先は **固定**
  - **Project内に新しい SubProject を作成する**
- 既存 SubProject 配下への展開・マージは **Phase 5 では行わない**
- 既存構造への編集は CLI 側に委譲

結果：
- Template Apply UI の分岐を最小化
- 既存構造を壊さない安全な適用フローを保証

---

## 確定事項③：テンプレ名リネーム

- Phase 5 UI では **テンプレ名の変更は不可**
- 名前修正が必要な場合は
  - **削除 → 再作成** で対応
- UI上のリネーム操作・衝突処理は実装しない

---

## テンプレ機能 UI の基本構成

### Template Hub
- テンプレ一覧表示
- テンプレ詳細（構造サマリ）
- 適用（Apply Wizard）入口
- 削除（要確認）

### Template Save Wizard
- SubProjectを基点としてテンプレ保存
- include_tasks ON/OFF 対応
- 名前入力 → 確認 → 保存

### Template Apply Wizard
- 適用先選択なし（新SubProject固定）
- ステータス初期化方針選択
- **dry-run 表示必須**
- 実行確認 → 展開後のSubProjectへ遷移

---

## Textual UI とロジック層の責務分離

### Textual（Phase 5）
- 画面描画
- 入力受付
- フロー制御
- 確認・dry-run結果表示

### ロジック層（既存CLIロジック）
- DB操作
- 検証
- dry-run 実処理
- テンプレ保存 / 適用の実体処理

※ 呼び出しは **同一プロセス内でロジック層を import** する前提  
※ subprocess による CLI 呼び出しは想定しない

---

## 設計思想まとめ

- Phase 5 は「編集UI」ではない
- 既存構造を壊さない
- 安全・単純・迷路化しないUIを優先
- 柔軟性・高度編集は CLI または将来フェーズに委譲

以上を Phase 5（Textual版）実装の前提とする。
